<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
  </head>

  <body>
    <button onclick="startComputingPrimes()">Start Computing Primes</button>
    <div id="primes-count"></div>
  </body>

  <script type="text/javascript">
    function isPrime(n) {
      for (let i = 2; i < n; i++) {
        if (n % i === 0) return false;
      }
      return true;
    }

    function computePrimes(onPrime, startAt = 1) {
      let currNum;
      for (currNum = startAt; currNum % 500 !== 0; currNum++) {
        if (isPrime(currNum)) onPrime(currNum);
      }
      setTimeout(() => computePrimes(onPrime, currNum + 1), 0); // Magicâ€½
    }

    let primesCount = 0;
    const primesCountDiv = document.getElementById('primes-count');

    function startComputingPrimes() {
      computePrimes(prime => {
        primesCount += 1;
        if (primesCount % 500 === 0) {
          const msg = `Total Primes Found: ${primesCount}`;
          primesCountDiv.textContent = msg;
          console.log(msg);
        }
      });
    }
  </script>
</html>
